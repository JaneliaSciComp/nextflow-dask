params {
    lsf_opts = ""
    runtime_opts = ""
    singularity_cache_dir = "$HOME/.singularity_cache"
}

profiles {

    standard {
        docker {
            enabled = false
        }

        singularity {
            enabled = true
        }
    }

    lsf {
        params {
            scheduler_mem_gb_per_core = 15
            worker_mem_gb_per_core = 15
            worker_threads = 2
            worker_queue = ''
            worker_lsf_opts = ''
        }

        process {
            executor = 'lsf'

            clusterOptions = params.lsf_opts

            withLabel: 'workerClusterOptions' {
                queue = params.worker_queue ? params.worker_queue : ''
                clusterOptions = "${params.lsf_opts} ${params.worker_lsf_opts}"
            }
        }

        docker {
            enabled = false
        }

        singularity {
            enabled = true
        }

    }
}

docker {
    temp = "auto"
    runOptions = "-v $PWD:$PWD ${params.runtime_opts}"
}

singularity {
    autoMounts = true
    cacheDir = "${params.singularity_cache_dir}"
    runOptions = "--nv -B $PWD ${params.runtime_opts}"
}
